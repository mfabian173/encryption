<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Encrypted Breach</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>
</head>
<body>

<!-- LOADING STATUS -->
<p id="loading">‚è≥ Initializing investigation environment‚Ä¶</p>

<!-- BRIEFING -->
<div id="briefing">
  <h1>URGENT</h1>

  <div class="case-box">
    <p><strong>CASE #</strong> CS-2025-001</p>
    <p><strong>Title:</strong> The Missing Data Case</p>
  </div>

  <h2>Priority</h2>
  <p class="critical">CRITICAL ‚Äî Immediate action required</p>

  <h2>Time Allocated</h2>
  <p>45 minutes ‚Äî Complete all phases</p>

  <h2>Objective</h2>
  <ul>
    <li>Identify culprit</li>
    <li>Use all available evidence</li>
  </ul>

  <h2>Case Summary</h2>
  <p class="instruction">Read carefully before beginning your investigation.</p>

  <p>
    At <strong>03:47 AM on February 16th, 2026</strong>, the TechCorp security system
    detected unauthorized access to the company‚Äôs main database.
    Critical customer data files were accessed and potentially compromised.
  </p>

  <p>
    The security team managed to preserve several pieces of evidence before
    the attacker covered their tracks:
  </p>

  <ul>
    <li>An encrypted note left behind in the server logs</li>
    <li>Server login logs showing suspicious access patterns</li>
    <li>A suspicious image file uploaded to the system</li>
    <li>Employee alibi records from the night of the breach</li>
    <li>Complete suspect profiles of all employees with system access</li>
  </ul>

  <p>
    Your mission is to analyze this evidence using computer science techniques
    to identify the culprit. You will decrypt messages, analyze data patterns,
    extract hidden information, and apply logical reasoning to solve the case.
  </p>

  <button id="beginBtn" onclick="beginInvestigation()">
    ‚ñ∂ BEGIN INVESTIGATION
  </button>
</div>

<!-- ROOM 1 -->
<div id="room1" class="room" style="display:none;">
  <h2>Room 1: Server Logs</h2>
  <p>Investigators recovered an encrypted note from the server logs. Use Python ciphers to decrypt it.</p>

  <!-- Detective briefs -->
  <div class="briefs-folder">
    <div class="brief-card" onclick="showBrief('atbash')">Atbash</div>
    <div class="brief-card" onclick="showBrief('caesar')">Caesar</div>
    <div class="brief-card" onclick="showBrief('rot13')">ROT13</div>
    <div class="brief-card" onclick="showBrief('vigenere')">Vigen√®re</div>
    <div class="brief-card" onclick="showBrief('base64')">Base64</div>
  </div>
  <div id="briefDisplay" class="brief-display">Select a cipher brief to learn more.</div>

  <!-- Secret file display (scrambled ROT13) -->
  <div class="secret-file">
    <pre id="secretMessage" data-original="VA BAR UBHE, NYY BS LBHE SVYRF JVYY OR JVCRQ SBERIRE. YRG GUR TNZRF ORTVA!
      CNFFJBEQ: CEBTENZZRE">
VA BAR UBHE, NYY BS LBHE SVYRF JVYY OR JVCRQ SBERIRE. YRG GUR TNZRF ORTVA! CNFFJBEQ: CEBTENZZRE
    </pre>
  </div>

  <!-- Python code input -->
  <p>Write your Python print statement using a cipher to decode the message:</p>
  <textarea id="code1" placeholder='Example: print(atbash("VA BAR UBHE, NYY BS LBHE SVYRF JVYY OR JVCRQ SBEIREIRE. YRG GUR TNZRF ORTVA!"))'></textarea>
  <button onclick="runPython('code1')">Run Python</button>
  <!-- Lock -->
  <div class="lock">
    <input id="answer1" placeholder="Enter decrypted message">
    <button onclick="unlock(1, 'PROGRAMMER')">
      Unlock
    </button>
    <p class="feedback" id="feedback1"></p>
  </div>
</div>
  

  
<!-- ROOM 2 -->
<div id="room2" class="room locked" style="display:none;">
  <div class="room-lock-overlay">
    <span>ACCESS DENIED</span>
  </div>
  <h2>Room 2: Login Logs</h2>
  <p class="instruction">
    You've successfully logged into the system. Here are the login logs from the night of the breach.
    All entries appear scrambled with a Caesar cipher. 
    As a reminder, we're working with this code:
    <pre class="code-snippet">
    def caesar(text, <span class="shift-highlight">shift</span>):
        result = ""
        for char in text:
            if char.isalpha():
                base = ord('A') if char.isupper() else ord('a')
                result += chr((ord(char) - base + <span class="shift-highlight">shift</span>) % 26 + base)
            else:
                result += char
        return result
    </pre>

  </p>

  <!-- Caesar shifted logs -->
  <div class="logs">
    <pre id="logData">
03:41:12 | XVHU_12 | 192.168.4.23 | RSHQHG ILOH: ilqdqfhv.csv
03:47:09 | XVHU_07 | 192.168.4.19 | RSHQHG ILOH: hpsorbhhbuhfrugv.db
03:52:44 | XVHU_07 | 192.168.4.19 | DFFHVV GHQLHG: dgplq.cfg
04:01:03 | XVHU_03 | 192.168.4.88 | RSHQHG ILOH: vhfuhw_nhb.mac
    </pre>
  </div>

  <!-- Caesar input -->
  <p>Enter the Caesar shift number you think was used to decode the logs:</p>
  <div class="code-input">
    <code>
      print(caesar(text,
      <input id="caesarShift" type="number" min="0" max="25" placeholder="?" />
      ))
    </code>
  </div>
  
  <button onclick="decodeCaesarLogs()">Run</button>

  <!-- Decoded logs -->
  <div class="logs">
    <pre id="decodedLogs"></pre>
  </div>
  
  <div id="challengeBox">
    <h4>Challenge: Loop</h4>
    <p>Instead of guessing the shift, try a loop through 0‚Äì26 to find the correct one!</p>
    <textarea id="challengeInput" placeholder="for value in..."></textarea>
    <button onclick="runChallenge()">Run Challenge</button>
  </div>

    <!-- Suspect list -->
  
<!-- Suspect Section -->
  <div id="suspectSection" style="display:none; margin-top:20px;">
    <h2 style="color:#ff5555; border-bottom:2px solid #ff5555; padding-bottom:5px;">
      SUSPECT LIST üîç
    </h2>
    <ul id="suspects" style="list-style:none; padding:0;"></ul>
  
    <!-- Suspect Bio Box -->
    <div id="suspectBio" style="display:none; border:2px solid #ff5555; padding:10px; margin-top:10px; background:#111; color:#fff;">
      <h3 id="bioName">Name</h3>
      <p><strong>Favorite Language:</strong> <span id="bioLang"></span></p>
      <p><strong>Access Level:</strong> <span id="bioAccess"></span></p>
      <p><strong>Recent File Access:</strong></p>
      <ul id="bioFiles"></ul>

      <button onclick="this.parentElement.style.display='none'" style="margin-top:5px; cursor:pointer;">Close</button>
    </div>
  </div>
</div>  
<div id="caseSidebar" style="position:fixed; right:0; top:50px; width:250px; padding:10px; border-left:2px solid #333;">
  <h3>Case File Progress</h3>
  <ul>
    <li id="progressNote">‚ùå Encrypted Note</li>
    <li id="progressLogs">‚ùå Server Logs</li>
    <li id="progressImage">‚¨ú Image Evidence</li>
    <li id="progressAlibi">‚¨ú Alibi Records</li>
  </ul>
</div>
]
  
<!-- ROOM 3 -->
<div id="room3" class="room" style="display:none;">
  <h2>Room 3: Image Evidence</h2>
  <p>A suspicious image file was accessed shortly before the breach.</p>
  <p><em>Steganography hides secret data inside files. Your mission is to extract the hidden message!</em></p>

  <div id="stegoImageContainer">
    <img id="stegoImage" src="images/room3_pre.png" width="300" alt="Suspicious image file">
    <img id="stegoReveal" src="images/room3_post.png" width="300" alt="Hidden data revealed" style="display:none;">
  </div>

  <!-- Cracked message -->
  <div id="crackedMessage" class="hidden">
    <h2>üîì CODE CRACKED</h2>
    <p>Hidden data successfully extracted.</p>
    <button onclick="unlockRoom4()">‚û° Proceed to Room 4</button>
  </div>

  <p>Below is the Python code to extract the hidden message. Fill in the missing parts marked with comments.</p>

  <pre style="background:#000;color:#0f0;padding:15px;border-radius:5px;overflow-x:auto;">
pixels = [(0,), (1,), (0,), (1,), (1,), (0,), (0,), (1,), 
          (0,), (1,), (1,), (0,), (1,), (0,), (1,), (0,)]
bits = []
chars = []
byte = []

# Step 1: Loop over each pixel
<code contenteditable="true" id="loopPixels" class="codeInput" style="color:#ff0;"> for ...:</code>

# Step 2: Append bit from pixel
<code contenteditable="true" id="appendBit" class="codeInput" style="color:#ff0;"> ...append...</code>

# Step 3: Loop over bits
<code contenteditable="true" id="loopBits" class="codeInput" style="color:#ff0;"> for...</code>

# Step 4: Append bit to byte
<code contenteditable="true" id="addByte" class="codeInput" style="color:#ff0;">...append...</code>

# Behind the scenes: convert 8 bits to characters
i = 0
while i < len(bits):
    byte_chunk = bits[i:i+8]
    if len(byte_chunk) == 8:
        value = 0
        for b in byte_chunk:
            value = value * 2 + b
        chars.append(chr(value))
    i += 8

  </pre>

  <button onclick="runRoom3()" style="margin-top:10px;">Run Code</button>
  <div id="stegoOutput" style="white-space:pre-wrap;margin-top:10px;font-family:monospace;color:#0f0;background:#000;padding:10px;"></div>
</div>

<div id="room4" class="room" style="display:none;">
  <h2>Room 4: Vigen√®re Cipher Challenge</h2>

  <p>
    A partially obscured document has been recovered.<br>
    Use the <strong>Vigen√®re cipher</strong> and the correct keyword to decode it.
  </p>

  <!-- Vigen√®re input area -->
  <textarea
    id="vigenereInput"
    placeholder="# Step 1: Define the keyword
# Step 2: Decode the document
# Step 3: Print the result

key = \"YOUR_KEYWORD\"
decoded = vigenere_decode(CIPHERTEXT, key)
print(decoded)"
    style="width:100%; height:180px;"
  ></textarea>

  <button onclick="runVigenere()">Run Code</button>
  
  <div id="mysticalDoc" class="mystical-doc hidden">
    <div class="doc-header">üìú RECOVERED ARCHIVE FRAGMENT</div>
    <pre id="mysticalText"></pre>
  </div>

  <div
    id="vigenereOutput"
    style="
      white-space: pre-wrap;
      margin-top:10px;
      font-family: monospace;
      color:#0f0;
      background:#000;
      padding:10px;
    "
  ></div>

  <!-- Suspect profiles -->
  <div id="suspectProfiles" style="margin-top:20px;">

    <!-- USER_03 -->
    <div id="user03Profile" class="case-box hidden">
      <h2>üîç SUSPECT PROFILE UNLOCKED</h2>
      <p><strong>User:</strong> USER_03</p>
      <p><strong>Name:</strong> Alice Mercer</p>
      <p><strong>Role:</strong> Systems Engineer</p>
      <h3>Alibi Statement</h3>
      <p>‚ÄúLeft the building at 03:30.‚Äù</p>
    </div>

    <!-- USER_07 -->
    <div id="user07Profile" class="case-box hidden">
      <h2>üîç SUSPECT PROFILE UNLOCKED</h2>
      <p><strong>User:</strong> USER_07</p>
      <p><strong>Name:</strong> Charlie Mercer</p>
      <p><strong>Role:</strong> Security Officer</p>
      <h3>Alibi Statement</h3>
      <p>‚ÄúStarted morning surveillance at 04:00.‚Äù</p>
    </div>

    <!-- USER_12 -->
    <div id="user12Profile" class="case-box hidden">
      <h2>üîç SUSPECT PROFILE UNLOCKED</h2>
      <p><strong>User:</strong> USER_12</p>
      <p><strong>Name:</strong> Bob Mercer</p>
      <p><strong>Role:</strong> Chief Financial Officer</p>
      <h3>Alibi Statement</h3>
      <p>‚ÄúSleeping soundly all night.‚Äù</p>
    </div>

  </div>
</div>


  <!-- Final report input -->
  <div id="finalReport" class="case-box hidden" style="margin-top:20px;">
    <h2>üß† Final Analysis</h2>
    <p>Review all evidence collected across the investigation. Only one suspect's alibi cannot be true based on system logs.</p>
    <p>File your final report when ready.</p>
    <label>Identified Culprit:</label>
    <input id="culpritInput" placeholder="Enter suspect name">
    <button onclick="submitCulprit()">Submit Report</button>
    <p id="finalFeedback" style="margin-top:10px;"></p>
  </div>
</div>

<div id="detectiveReport" class="report hidden">
  <h1>üóÇ DETECTIVE REPORT</h1>

  <label>Case ID</label>
  <input value="CS-2025-001" disabled>

  <label>Identified Culprit</label>
  <input id="culpritInput" placeholder="Enter suspect name">

  <button onclick="submitReport()">Submit Final Report</button>

  <p id="reportFeedback"></p>
</div>

<div id="victoryScreen" class="victory hidden">
  <h1>üèÜ CASE CLOSED</h1>
  <p>You solved the case using:</p>
  <ul>
    <li>Python loops</li>
    <li>String manipulation</li>
    <li>Logical reasoning</li>
  </ul>
  <p><strong>Excellent detective work.</strong></p>
</div>

<script src="app.js"></script>
</body>
</html>
